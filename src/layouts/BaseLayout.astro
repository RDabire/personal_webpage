---
import '../styles/global.css';
import { defaultLanguage, useTranslations, type LanguageCode } from '@/i18n/ui';
import Footer from '@/components/Footer.astro';
import Header from '@/components/Header.astro';
import BottomAppBar from '@/components/BottomAppBar.astro';
import { Home, FileText, FileUser } from 'lucide-react';
import { ClientRouter } from 'astro:transitions';

import { Toaster } from 'sonner';

type Props = {
  pageTitle: string;
  pageDescription?: string;
};

export type NavItem = {
  href: string;
  label: string;
  icon: any;
};

const { pageTitle, pageDescription } = Astro.props;
const lang =
  (Astro.currentLocale as LanguageCode | undefined) ?? defaultLanguage;
const tSite = useTranslations(lang, 'site');
const tNav = useTranslations(lang, 'nav');

const navItems: Array<NavItem> = [
  { href: '/', label: tNav('home'), icon: Home },
  { href: '/resume', label: tNav('resume'), icon: FileUser },
  { href: '/blog', label: tNav('blog'), icon: FileText },
];
---

<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content={pageDescription || tSite('description')}
    />

    <link
      rel="icon"
      type="image/png"
      href="/favicons/light-mode/favicon-96x96.png"
      sizes="96x96"
      media="(prefers-color-scheme: light)"
    />
    <link
      rel="icon"
      type="image/png"
      href="/favicons/dark-mode/favicon-96x96.png"
      sizes="96x96"
      media="(prefers-color-scheme: dark)"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="/favicons/light-mode/favicon.svg"
      media="(prefers-color-scheme: light)"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="/favicons/dark-mode/favicon.svg"
      media="(prefers-color-scheme: dark)"
    />

    <link
      rel="shortcut icon"
      href="/favicons/light-mode/favicon.ico"
      media="(prefers-color-scheme: light)"
    />
    <link
      rel="shortcut icon"
      href="/favicons/dark-mode/favicon.ico"
      media="(prefers-color-scheme: dark)"
    />

    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/favicons/light-mode/apple-touch-icon.png"
      media="(prefers-color-scheme: light)"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/favicons/dark-mode/apple-touch-icon.png"
      media="(prefers-color-scheme: dark)"
    />

    <link
      rel="manifest"
      href="/favicons/light-mode/site.webmanifest"
      media="(prefers-color-scheme: light)"
    />
    <link
      rel="manifest"
      href="/favicons/dark-mode/site.webmanifest"
      media="(prefers-color-scheme: dark)"
    />

    <script is:inline>
      const getInitialTheme = () => {
        if (
          typeof localStorage !== 'undefined' &&
          localStorage.getItem('theme')
        ) {
          return localStorage.getItem('theme');
        }
        if (
          window.matchMedia &&
          window.matchMedia('(prefers-color-scheme: dark)').matches
        ) {
          return 'dark';
        }
        return 'light';
      };
      const theme = getInitialTheme();
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
      }
      // Ensure localStorage is consistent if theme was derived from prefers-color-scheme
      // or if localStorage was empty.
      if (typeof localStorage !== 'undefined') {
        localStorage.setItem('theme', theme);
      }
    </script>
    <title>{pageTitle || tSite('title')}</title>

    {/* Font, for example Google Fonts - to adapt according to your choices */}
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.min.js"
      defer></script>
  </head>
</html>
